{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'emt/css/iqac_suite_dashboard.css' %}">

<div class="suite-dashboard-container">
  <h1 class="suite-dashboard-title">IQAC Suite Dashboard</h1>

  <div class="suite-dashboard-body">
    
    <!-- LEFT: CARDS -->
    <div class="suite-left-section">
      <!-- Event Proposal -->
      <div class="suite-card suite-card-hover suite-glass">
        <div class="suite-card-icon suite-card-icon-blue">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <path d="M14 2v6h6"/>
            <path d="M8 16v-2"/>
            <path d="M12 16v-4"/>
            <path d="M16 16v-3"/>
          </svg>
        </div>
        <div class="suite-card-title">Event Proposal</div>
        <div class="suite-card-desc">Create and manage event proposals</div>
        <a href="{% url 'emt:submit_proposal' %}" class="suite-card-btn">Go &rarr;</a>
      </div>

      <!-- IQAC Report Generation -->
      <div class="suite-card suite-card-hover suite-glass">
        <div class="suite-card-icon suite-card-icon-purple">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="none" stroke="#8b5cf6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <rect x="5" y="4" width="14" height="18" rx="2" ry="2"/>
            <path d="M9 2h6a1 1 0 0 1 1 1v1H8V3a1 1 0 0 1 1-1z"/>
            <line x1="9" y1="9" x2="15" y2="9"/>
            <line x1="9" y1="13" x2="15" y2="13"/>
            <line x1="9" y1="17" x2="13" y2="17"/>
          </svg>
        </div>
        <div class="suite-card-title">IQAC Report Generation</div>
        <div class="suite-card-desc">Generate IQAC reports</div>
        <a href="{% url 'emt:pending_reports' %}" class="suite-card-btn">Go &rarr;</a>
      </div>

      <!-- View Generated Reports -->
      <div class="suite-card suite-card-hover suite-glass">
        <div class="suite-card-icon suite-card-icon-green">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="none" stroke="#22c55e" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M6 2h9l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z"/>
            <path d="M15 2v5h5"/>
            <path d="M8 11h8"/>
            <path d="M8 15h5"/>
          </svg>
        </div>
        <div class="suite-card-title">View Generated Reports</div>
        <div class="suite-card-desc">See all your generated reports</div>
        <a href="{% url 'emt:generated_reports' %}" class="suite-card-btn">Go &rarr;</a>
      </div>

      <!-- Event Approvals -->
      {% if user.is_authenticated and show_approvals_card %}
      <div class="suite-card suite-card-hover suite-glass">
        <div class="suite-card-icon suite-card-icon-orange">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="none" stroke="#f97316" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"/>
            <path d="M9 12l2 2 4-4"/>
          </svg>
        </div>
        <div class="suite-card-title">Event Approvals</div>
        <div class="suite-card-desc">Review and approve event proposals</div>
        <a href="{% url 'emt:my_approvals' %}" class="suite-card-btn">Go &rarr;</a>
      </div>
      {% endif %}
    </div>

    <!-- RIGHT: NOTIFICATIONS -->
    <div class="suite-right-section suite-glass">
      <div class="notif-heading">Notifications</div>
      <div class="notif-box">
        {% if user_proposals %}
          <ul class="notif-list">
            {% for proposal in user_proposals %}
              <li class="notif-item animate-fade-in">
                <div class="notif-row">
                  <span class="notif-event-title">{{ proposal.event_title }}</span>
                  {% if proposal.status == 'submitted' %}
                    <span class="notif-status notif-status-pending">Submitted</span>
                  {% elif proposal.status == 'under_review' %}
                    <span class="notif-status notif-status-review">Under Review</span>
                  {% elif proposal.status == 'rejected' %}
                    <span class="notif-status notif-status-rejected">Rejected</span>
                  {% elif proposal.status == 'returned' %}
                    <span class="notif-status notif-status-feedback">Returned</span>
                  {% endif %}
                </div>
                {% if proposal.return_comment %}
                  <div class="notif-feedback"><b>Feedback:</b> {{ proposal.return_comment }}</div>
                {% endif %}
                <div class="status-bar mt-2">
                  {% for status in statuses %}
                    <span class="status-dot
                      {% if forloop.counter0 == proposal.status_index %}
                        status-dot-current
                      {% elif forloop.counter0 < proposal.status_index %}
                        status-dot-past
                      {% else %}
                        status-dot-future
                      {% endif %}
                    " title="{{ status|capfirst }}"></span>
                    {% if not forloop.last %}
                      <span class="status-bar-line"></span>
                    {% endif %}
                  {% endfor %}
                </div>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="notif-empty">
            <span>ðŸŽ‰ All clear! No proposals need your attention right now.</span>
          </div>
        {% endif %}
      </div>
    </div>

  </div>
</div>
{% endblock %}
