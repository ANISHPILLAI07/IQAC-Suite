{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'emt/css/iqac_generated_reports.css' %}">

<div class="iqac-dashboard-bg">
  <div class="iqac-dashboard-container">
    <!-- Header Section -->
    <div class="iqac-page-header">
      <div class="iqac-header-content">
        <div class="iqac-header-icon">
          <span class="iqac-section-emoji">ðŸ“„</span>
        </div>
        <div class="iqac-header-text">
          <h1 class="iqac-page-title">Generated Reports</h1>
          <p class="iqac-page-subtitle">View Generated Reports</p>
        </div>
      </div>
    </div>

    <!-- Table Section -->
    <div class="iqac-table-container">
      {% if reports %}
        <div class="iqac-table-wrapper">
          <table class="iqac-reports-table">
            <thead>
              <tr>
                <th class="iqac-th-icon"></th>
                <th class="iqac-th-title">Event Title</th>
                <th class="iqac-th-status">Generated Date</th>
                <th class="iqac-th-actions">Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for report in reports %}
                <tr class="iqac-table-row">
                  <td class="iqac-td-icon">
                    <div class="iqac-doc-icon">
                      <svg width="32" height="40" viewBox="0 0 32 40" fill="none">
                        <rect width="32" height="40" rx="7" fill="#2A4B8D" fill-opacity="0.12"/>
                        <rect x="5" y="8" width="22" height="24" rx="3" fill="#2A4B8D" />
                        <rect x="8.5" y="13.5" width="15" height="2" rx="1" fill="#fff"/>
                        <rect x="8.5" y="18.5" width="11" height="2" rx="1" fill="#fff"/>
                      </svg>
                    </div>
                  </td>
                  <td class="iqac-td-title">
                    <div class="iqac-event-info">
                      <div class="iqac-event-title">{{ report.event_title|default:"(Untitled Event)" }}</div>
                    </div>
                  </td>
                  <td class="iqac-td-status">
                    <span class="iqac-status-badge">{{ report.generated_at|date:"M d, Y" }}</span>
                  </td>
                  <td class="iqac-td-actions">
                    <div class="iqac-action-buttons">
                      <a href="{% url 'emt:view_report' report.id %}" class="iqac-action-btn view-btn" title="View Report">View</a>
                      <div class="iqac-download-dropdown">
                        <button class="iqac-action-btn download-btn">Download</button>
                        <div class="iqac-download-options">
                          <a href="{% url 'emt:download_pdf' report.id %}">PDF</a>
                          <a href="{% url 'emt:download_word' report.id %}">Word</a>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="iqac-empty-state">
          <div class="iqac-empty-icon">ðŸ“„</div>
          <div class="iqac-empty-msg">No reports have been generated yet.</div>
        </div>
      {% endif %}
    </div>
  </div>
</div>
<script>
  // Simple dropdown toggle logic for download options
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.iqac-download-dropdown').forEach(function(drop) {
      drop.querySelector('.download-btn').onclick = function(e) {
        e.stopPropagation();
        drop.querySelector('.iqac-download-options').classList.toggle('show');
      };
    });
    document.body.onclick = function() {
      document.querySelectorAll('.iqac-download-options').forEach(function(d) {
        d.classList.remove('show');
      });
    };
  });
</script>
{% endblock %}