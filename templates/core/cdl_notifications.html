{% extends "base.html" %}
{% load static %}

{% block title %}CDL Notifications â€” Event Management Suite{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{% static 'core/css/dashboard.css' %}">
<style>
  .notifications-page { padding: 16px; }
  .notifications-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
  .notifications-header h1 { margin:0; font-size:1.5rem; }
  .table-card { background:#fff; border-radius:12px; box-shadow:0 4px 16px rgba(0,0,0,0.08); overflow:hidden; }
  .table-responsive { overflow-x:auto; }
  table.notifications-table { width:100%; border-collapse:collapse; }
  table.notifications-table thead th { background:#1e60b1; color:#fff; text-align:left; padding:12px 16px; font-weight:600; white-space:nowrap; }
  table.notifications-table tbody td { padding:12px 16px; border-top:1px solid #eef2f7; vertical-align:middle; }
  table.notifications-table tbody tr:nth-child(even) { background:#f9fbff; }
  .status-pill { display:inline-block; padding:4px 10px; border-radius:999px; font-size:12px; font-weight:600; }
  .status-finalized { background:#d1fae5; color:#065f46; }
  .btn-view { display:inline-flex; align-items:center; gap:6px; padding:8px 12px; background:#1e60b1; color:#fff; border-radius:8px; text-decoration:none; white-space:nowrap; }
  .btn-view:hover { filter:brightness(0.95); text-decoration:none; }
  .subhead { margin:0 0 8px 0; color:#6b7280; }
  .back-btn { display:inline-flex; align-items:center; gap:6px; padding:8px 12px; border-radius:8px; border:1px solid #e5e7eb; color:#374151; text-decoration:none; }
</style>
{% endblock %}

{% block content %}
<div class="notifications-page">
  <div class="notifications-header">
    <div>
      <h1>CDL Notifications</h1>
      <p class="subhead">Finalized proposals related to CDL, in first-come-first-serve order.</p>
    </div>
    <div class="toolbar">
      <a href="{% url 'cdl_head_dashboard' %}" class="back-btn"><i class="fa-solid fa-arrow-left"></i> Back to CDL Dashboard</a>
    </div>
  </div>

  <div class="table-card">
    <div class="table-responsive">
      <table class="notifications-table">
        <thead>
          <tr>
            <th>Event Title</th>
            <th>Submitted By</th>
            <th>Date Submitted</th>
            <th>Organization</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% if notifications %}
            {% for p in notifications %}
              <tr>
                <td>{{ p.event_title }}</td>
                <td>{{ p.submitted_by.get_full_name|default:p.submitted_by.username }}</td>
                <td>{{ p.created_at|date:'M d, Y h:i A' }}</td>
                <td>{{ p.organization.name|default:'-' }}</td>
                <td><span class="status-pill status-finalized">Finalized</span></td>
                <td>
                  <div style="display:flex; gap:8px; flex-wrap:wrap">
                    <a class="btn-view" href="{% url 'cdl_support_detail_page' %}?eventId={{ p.id }}"><i class="fa-regular fa-eye"></i> View</a>
                    <a class="btn-view" href="{% url 'cdl_assign_tasks_page' p.id %}?eventId={{ p.id }}"><i class="fa-regular fa-pen-to-square"></i> Assign</a>
                    <a class="btn-view" href="{% url 'cdl_communication_page' %}?eventId={{ p.id }}"><i class="fa-regular fa-comments"></i> Chat</a>
                  </div>
                </td>
              </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="6" class="empty-state">No CDL notifications to show.</td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
