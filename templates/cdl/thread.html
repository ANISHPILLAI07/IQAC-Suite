{% extends "base.html" %}
{% block title %}CDL Thread{% endblock %}
{% block content %}
<h1>CDL Communication</h1>
<div class="border p-3 mb-3" style="max-height:400px; overflow-y:auto;">
  {% for m in messages %}
    <div class="mb-2">
      <strong>{{ m.author.username }}</strong> <small class="text-muted">{{ m.created_at }}</small><br>
      <div>{{ m.body|linebreaksbr }}</div>
      {% if m.file %}<a href="{{ m.file.url }}">Attachment</a>{% endif %}
    </div>
  {% empty %}
    <p class="text-muted">No messages yet.</p>
  {% endfor %}
</div>
<form method="post" enctype="multipart/form-data" class="mt-3">
  {% csrf_token %}
  {{ form.body.label_tag }} {{ form.body }}
  {{ form.file.label_tag }} {{ form.file }}
  <div class="form-check">{{ form.sent_via_email }} {{ form.sent_via_email.label_tag }}</div>
  <button class="btn btn-primary mt-2" type="submit">Post</button>
</form>
{% endblock %}
